{"ast":null,"code":"/**\n * Title: signin.component.ts\n * Author: Jocelyn Dupuis\n * Date: 01/18/2024\n * Description: ts file for signin component\n */\nimport { __decorate } from \"tslib\";\n//import statements\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\n//signin component\nexport let SigninComponent = class SigninComponent {\n  //constructor created that passes the following\n  constructor(route, router, cookieService, securityService, fb) {\n    this.route = route;\n    this.router = router;\n    this.cookieService = cookieService;\n    this.securityService = securityService;\n    this.fb = fb;\n    this.isLoading = false;\n    //form builder creates signin form that and accepts numerical values\n    this.signinForm = this.fb.group({\n      empId: [null, Validators.compose([Validators.required, Validators.pattern('^[0-9]*$')])]\n    });\n    this.sessionUser = {}; //default value set\n    this.errorMessage = ''; //default value set\n  }\n  //function for user to signin\n  signin() {\n    //set isLoading to true and get Id from form\n    this.isLoading = true;\n    console.log(\"signinForm\", this.signinForm.value);\n    const empId = this.signinForm.controls['empId'].value;\n    //if ID is not valid an error message is displayed\n    if (!empId || isNaN(parseInt(empId, 10))) {\n      this.errorMessage = 'The employee ID is invalid. Please enter a number.';\n      this.isLoading = false;\n      return;\n    }\n    //subscribe to security service\n    this.securityService.findEmployeeById(empId).subscribe({\n      next: employee => {\n        console.log('employee', employee);\n        //session user to the logged employee\n        this.sessionUser = employee;\n        //gives user two session cookies to name and Id\n        this.cookieService.set('session_user', empId, 1);\n        this.cookieService.set('session_name', `${employee.firstName} ${employee.lastName}`, 1);\n        //returns url\n        const returnUrl = this.route.snapshot.queryParamMap.get('returnUrl') || '/';\n        this.isLoading = false;\n        this.router.navigate([returnUrl]);\n      },\n      error: err => {\n        this.isLoading = false;\n        if (err.error.message) {\n          this.errorMessage = err.error.message;\n          return;\n        }\n        //sets value of error message\n        this.errorMessage = err.message;\n      }\n    });\n  }\n};\nSigninComponent = __decorate([Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.css']\n})], SigninComponent);","map":{"version":3,"names":["Component","Validators","SigninComponent","constructor","route","router","cookieService","securityService","fb","isLoading","signinForm","group","empId","compose","required","pattern","sessionUser","errorMessage","signin","console","log","value","controls","isNaN","parseInt","findEmployeeById","subscribe","next","employee","set","firstName","lastName","returnUrl","snapshot","queryParamMap","get","navigate","error","err","message","__decorate","selector","templateUrl","styleUrls"],"sources":["/Users/jocelynthegreat/Documents/buwebdev/nodebucket/src/app/security/signin/signin.component.ts"],"sourcesContent":["/**\n * Title: signin.component.ts\n * Author: Jocelyn Dupuis\n * Date: 01/18/2024\n * Description: ts file for signin component\n */\n\n//import statements\nimport { Component } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CookieService } from 'ngx-cookie-service';\nimport { SecurityService } from '../security.service';\n\n//exports session user interface\nexport interface SessionUser {\n  empId: number;\n  firstName: string;\n  lastName: string;\n}\n\n//signin component\n@Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.css']\n})\n\nexport class SigninComponent {\n  //variables created\n  errorMessage: string;\n  sessionUser: SessionUser;\n  isLoading: boolean = false;\n\n  //form builder creates signin form that and accepts numerical values\n  signinForm = this.fb.group({\n    empId: [null, Validators.compose([Validators.required, Validators.pattern('^[0-9]*$')])]\n  });\n\n  //constructor created that passes the following\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private cookieService: CookieService,\n    private securityService: SecurityService,\n    private fb: FormBuilder\n  ) {\n    this.sessionUser = {} as SessionUser; //default value set\n    this.errorMessage = ''; //default value set\n  }\n\n  //function for user to signin\n  signin() {\n    //set isLoading to true and get Id from form\n    this.isLoading = true;\n    console.log(\"signinForm\", this.signinForm.value);\n    const empId = this.signinForm.controls['empId'].value;\n\n    //if ID is not valid an error message is displayed\n    if (!empId || isNaN(parseInt(empId, 10))) {\n      this.errorMessage = 'The employee ID is invalid. Please enter a number.';\n      this.isLoading = false;\n      return;\n    }\n\n    //subscribe to security service\n    this.securityService.findEmployeeById(empId).subscribe({\n      next: (employee: any) => {\n        console.log('employee', employee);\n\n        //session user to the logged employee\n        this.sessionUser = employee;\n        //gives user two session cookies to name and Id\n        this.cookieService.set('session_user', empId, 1);\n        this.cookieService.set('session_name', `${employee.firstName} ${employee.lastName}`, 1);\n\n        //returns url\n        const returnUrl = this.route.snapshot.queryParamMap.get('returnUrl') || '/';\n\n        this.isLoading = false;\n\n        this.router.navigate([returnUrl]);\n      },\n      error: (err) => {\n        this.isLoading = false;\n\n        if (err.error.message) {\n          this.errorMessage = err.error.message;\n          return;\n        }\n\n        //sets value of error message\n        this.errorMessage = err.message;\n      }\n    });\n  }\n}"],"mappings":"AAAA;;;;;;;AAOA;AACA,SAASA,SAAS,QAAQ,eAAe;AACzC,SAAsBC,UAAU,QAAQ,gBAAgB;AAYxD;AAOO,WAAMC,eAAe,GAArB,MAAMA,eAAe;EAW1B;EACAC,YACUC,KAAqB,EACrBC,MAAc,EACdC,aAA4B,EAC5BC,eAAgC,EAChCC,EAAe;IAJf,KAAAJ,KAAK,GAALA,KAAK;IACL,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,eAAe,GAAfA,eAAe;IACf,KAAAC,EAAE,GAAFA,EAAE;IAbZ,KAAAC,SAAS,GAAY,KAAK;IAE1B;IACA,KAAAC,UAAU,GAAG,IAAI,CAACF,EAAE,CAACG,KAAK,CAAC;MACzBC,KAAK,EAAE,CAAC,IAAI,EAAEX,UAAU,CAACY,OAAO,CAAC,CAACZ,UAAU,CAACa,QAAQ,EAAEb,UAAU,CAACc,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC;KACxF,CAAC;IAUA,IAAI,CAACC,WAAW,GAAG,EAAiB,CAAC,CAAC;IACtC,IAAI,CAACC,YAAY,GAAG,EAAE,CAAC,CAAC;EAC1B;EAEA;EACAC,MAAMA,CAAA;IACJ;IACA,IAAI,CAACT,SAAS,GAAG,IAAI;IACrBU,OAAO,CAACC,GAAG,CAAC,YAAY,EAAE,IAAI,CAACV,UAAU,CAACW,KAAK,CAAC;IAChD,MAAMT,KAAK,GAAG,IAAI,CAACF,UAAU,CAACY,QAAQ,CAAC,OAAO,CAAC,CAACD,KAAK;IAErD;IACA,IAAI,CAACT,KAAK,IAAIW,KAAK,CAACC,QAAQ,CAACZ,KAAK,EAAE,EAAE,CAAC,CAAC,EAAE;MACxC,IAAI,CAACK,YAAY,GAAG,oDAAoD;MACxE,IAAI,CAACR,SAAS,GAAG,KAAK;MACtB;;IAGF;IACA,IAAI,CAACF,eAAe,CAACkB,gBAAgB,CAACb,KAAK,CAAC,CAACc,SAAS,CAAC;MACrDC,IAAI,EAAGC,QAAa,IAAI;QACtBT,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEQ,QAAQ,CAAC;QAEjC;QACA,IAAI,CAACZ,WAAW,GAAGY,QAAQ;QAC3B;QACA,IAAI,CAACtB,aAAa,CAACuB,GAAG,CAAC,cAAc,EAAEjB,KAAK,EAAE,CAAC,CAAC;QAChD,IAAI,CAACN,aAAa,CAACuB,GAAG,CAAC,cAAc,EAAE,GAAGD,QAAQ,CAACE,SAAS,IAAIF,QAAQ,CAACG,QAAQ,EAAE,EAAE,CAAC,CAAC;QAEvF;QACA,MAAMC,SAAS,GAAG,IAAI,CAAC5B,KAAK,CAAC6B,QAAQ,CAACC,aAAa,CAACC,GAAG,CAAC,WAAW,CAAC,IAAI,GAAG;QAE3E,IAAI,CAAC1B,SAAS,GAAG,KAAK;QAEtB,IAAI,CAACJ,MAAM,CAAC+B,QAAQ,CAAC,CAACJ,SAAS,CAAC,CAAC;MACnC,CAAC;MACDK,KAAK,EAAGC,GAAG,IAAI;QACb,IAAI,CAAC7B,SAAS,GAAG,KAAK;QAEtB,IAAI6B,GAAG,CAACD,KAAK,CAACE,OAAO,EAAE;UACrB,IAAI,CAACtB,YAAY,GAAGqB,GAAG,CAACD,KAAK,CAACE,OAAO;UACrC;;QAGF;QACA,IAAI,CAACtB,YAAY,GAAGqB,GAAG,CAACC,OAAO;MACjC;KACD,CAAC;EACJ;CACD;AApEYrC,eAAe,GAAAsC,UAAA,EAN3BxC,SAAS,CAAC;EACTyC,QAAQ,EAAE,YAAY;EACtBC,WAAW,EAAE,yBAAyB;EACtCC,SAAS,EAAE,CAAC,wBAAwB;CACrC,CAAC,C,EAEWzC,eAAe,CAoE3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}